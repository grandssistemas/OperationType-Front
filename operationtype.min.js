angular.module("operationtype.templates",[]).run(["$templateCache",function(e){e.put("baseOperationType.html",'<div class="gumga-layout"><header class="gl-header" ng-controller="MenuController"><div class="searchbar"><div class="icon back"><button type="button" data-ng-click="toggleSearch()"><i class="material-icons">arrow_back</i></button></div><div class="query"><input type="text" class="form-control" placeholder="Pesquisar..."></div><div class="icon search"><button type="button"><i class="material-icons">search</i></button></div></div><nav class="navbar"><div class="container-fluid"><div class="navbar-header"><a class="navbar-brand" data-ng-click="navCollapse()"><i class="material-icons">menu</i></a><a class="navbar-brand" data-ng-click="navCollapse()"><img height="30" width="110" src="resources/images/mobi_logo_pq.png" alt=""></a><button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false"><i class="material-icons">more_vert</i></button><button type="button" class="navbar-toggle" data-ng-click="toggleSearch()"><i class="material-icons">search</i></button></div><div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1"><ul class="nav navbar-nav organizations" title="Trocar de Organização"><li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"><i class="material-icons">domain</i></a><ul class="dropdown-menu"><li><div class="form-group"><input type="text" class="form-control gmd" data-ng-model="org_search" placeholder="Pesquisar..."><div class="bar"></div></div></li><li data-ng-repeat="org in organizations | filter: org_search"><a href="" ng-click="changeOrganization(org)">{{org.name}}<span class="glyphicon glyphicon-ok" ng-show="org.name == user.organization || org.name == user.name"></span></a></li><li role="separator" class="divider"></li></ul></li></ul><form class="navbar-form navbar-left search hidden-sm hidden-xs"><div class="form-group"><div class="input-group"><span class="input-group-addon" id="basic-addon1"><i class="material-icons">search</i></span><input type="text" ng-model="asyncSelected" placeholder="Pesquisar..." uib-typeahead="item.searchLabel for item in searchMenu($viewValue) | limitTo:10" class="form-control" typeahead-on-select="goToState($item)"></div></div></form><ul class="nav navbar-nav navbar-right"><li class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">{{user.name}}<span class="caret"></span></a><div class="dropdown-menu"><div class="row dropdown-account"><div class="col-xs-4"><img ng-src="{{user.profileImage}}" alt=""></div><div class="user-info"><b>{{user.name}}</b><span>{{user.login}}</span></div></div><hr style="margin-bottom: 10px"><div class="row"><div class="col-xs-12 dropdown-account-footer" style="padding:0 25px 10px 25px"><button ui-sref="user.profile" class="btn btn-primary raised gmd">Minha conta</button><div class="pull-right"><button type="button" ng-click="logout()" class="btn btn-default gmd" name="button">Sair</button></div></div></div></div></li></ul><ul class="nav navbar-nav navbar-right apps hidden-sm hidden-xs"><li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"><i class="material-icons">apps</i></a><ul class="dropdown-menu" style="min-width: 95px !important"><li class="apps-icons"><table class="table"><tr><td><a ng-click="openFinance()"><img src="dist/grands/images/finance.png" alt=""><span class="text-bold text-uppercase">Financeiro</span></a></td></tr></table></li></ul></li></ul></div></div></nav></header><main ui-view style="background-color: #f5f5f5"></main><nav class="gl-nav" ng-controller="MenuController"><div class="navbar-header"><a class="navbar-brand" data-ng-click="navCollapse()"><i class="material-icons">menu</i></a><a class="navbar-brand" data-ng-click="navCollapse()"><img height="30" width="110" src="resources/images/mobi_logo_pq.png" alt=""></a></div><header><figure style="padding: 25% 3% 3% 3%"><img style="max-height: 200px" ng-src="{{companyLogo}}" alt=""></figure></header><gl-menu menu="menu" keys="keys" search="menuSearch"></gl-menu></nav></div>'),e.put("modules/businessrule/views/BusinessRuleStepOne.html",'<form name="forms" novalidate autocomplete="off" class="has-footer"><div class="row"><div class="col-xs-10 col-xs-offset-1 col-md-10 col-md-offset-1" style="margin-top: 15px"><div class="row"><div class="col-xs-12"><h1 style="font-size: 18px">Regra Comercial<span class="businesrule-step">2</span><span class="businesrule-step businesrule-step-active">1</span></h1><div class="panel gmd"><div class="panel-heading" style="padding-bottom: 0"><div class="row"><div class="col-xs-12"><span>Operações<br><label style="font-size: 12px; color: var(--primary);    font-size: 12px;\n                                            color: var(--primary);\n                                            vertical-align: middle;\n                                            padding-top: 5px">Selecione os tipos de movimentações desta Regra Comercial:</label></span></div></div></div><div class="panel-body text-center"><div class="col-sm-6" style="padding-left: 0"><gumga-list data="operations" configuration="conf" on-click="onSelectedOperation($value)" name="operations" class="gmd" page-size="businessrule.pageSize" count="businessrule.count" page-model="businessrule.page" max-height="350px"></gumga-list></div><div class="col-sm-6"><div ng-show="selectedOperations.length == 0"><br><br><br><i class="material-icons" style="font-size: 12em;color: var(--primary)">compare_arrows</i><h5>Nenhum tipo de movimentação foi selecionado ainda.</h5></div><div ng-show="selectedOperations.length > 0"><div><i class="material-icons" style="font-size: 50px;color: var(--primary)">compare_arrows</i></div><div><label style="font-size: 24px;color: #5d5757">Movimentações selecionadas:</label><br><br></div><div class="row"><div class="col-xs-12"><p ng-repeat="op in selectedOperations" class="operation-item" style="padding: 5px;padding-right: 10px;   padding-left: 10px">{{op.name}}<i class="material-icons" ng-click="removeOperation(op)">delete</i></p></div></div></div></div></div><div class="panel-footer"><button type="button" class="btn btn-primary button-ok" ng-click="nextStep()" ng-disabled="!selectedOperations.length">Próximo</button><button type="button" grands-button="cancel" class="pull-left" ng-click="back()"></button></div></div></div></div></div></div></form>'),e.put("modules/businessrule/views/BusinessRuleStepTwo.html",'<form name="forms" novalidate autocomplete="off" class="has-footer"><div class="row"><div class="col-xs-10 col-xs-offset-1 col-md-10 col-md-offset-1" style="margin-top: 15px"><div class="row"><div class="col-xs-12"><h1 style="font-size: 18px">Regra Comercial<span class="businesrule-step businesrule-step-active">2</span><span class="businesrule-step businesrule-step-finish">1</span></h1><div class="panel gmd"><div class="panel-heading" style="padding-bottom: 0"><div class="row"><div class="col-sm-10"><span style="float: left;margin-right: 10px">Operações :</span><p ng-repeat="op in operations" class="operation-item">{{op.name}}</p></div><div class="col-sm-2"><style>grands-check-button > div{\n                                            text-align: center;\n                                        }\n                                        grands-check-button label[class~="cl-text-icons"], grands-check-button label[class~="cl-light-primary"]{\n                                            font-size: 12px;\n                                            padding-left: 10px;\n                                            padding-top: 0px !important;\n                                            vertical-align: initial !important;\n                                        }</style><grands-check-button value="active" label="{{active ? \'Ativo\' : \'Inativo\'}}" click="active = !active"></grands-check-button></div></div></div><div class="panel-body"><div class="row"><div class="col-md-4 col-md-offset-2"><grands-big-active-button id="paymentInCred" click="changeMethod(\'ENTRY\')" active="entry" class="btn-success"><i class="material-icons cl-text-icons cursor-pointer" style="font-size: 30px;vertical-align: sub">monetization_on</i><label class="cl-text-icons cursor-pointer" style="padding-top: 5%;padding-bottom: 5%;font-size: 30px;padding-left: 4%">À Vista</label></grands-big-active-button></div><div class="col-md-4"><grands-big-active-button id="paymentInCred" click="changeMethod(\'PARCEL\')" active="parcel" class="btn-success"><i class="material-icons cl-text-icons cursor-pointer" style="font-size: 30px;vertical-align: sub">payment</i><label class="cl-text-icons cursor-pointer" style="padding-top: 5%;padding-bottom: 5%;font-size: 30px;padding-left: 4%">À Prazo</label></grands-big-active-button></div></div><div class="panel gmd m-t-md" ng-show="entry"><div class="col-md-8 col-md-offset-2" style="padding: 5px"><gumga-list data="paymentTypes" configuration="confEntry" class="gmd" selected-values="selectedEntryType" max-height="300px"></gumga-list></div></div><div class="panel gmd m-t-md" ng-show="parcel"><div class="col-md-8 col-md-offset-2" style="padding: 5px"><gumga-list data="paymentTypes" configuration="confParcel" class="gmd" selected-values="selectedParcelType" on-row-change="onChangeRow(row)" max-height="300px"></gumga-list></div></div></div><div class="panel-footer"><button type="button" class="btn btn-primary button-ok" ng-click="generate()" ng-disabled="disableBtnSave()"><i class="material-icons media-bottom">save</i><span>Salvar</span></button><button type="button" grands-button="cancel" class="pull-left" ng-click="back()"></button></div></div></div></div></div></div></form>'),e.put("modules/businessrule/views/form.html",'<form name="forms" novalidate><div class="row"><div class="col-lg-12"><div class="ibox float-e-margins"><div class="ibox-content"><div class="row"><div class="col-md-12"><label gumga-translate-tag="businessrule.typeofmovement">Type of Movement</label><strong class="text-danger" ng-show="entity.operationOwner.length <= 0">*</strong><select multiple chosen data-placeholder="Tipo de movimento..." ng-model="entity.operationOwner" ng-options="op as op.name for op in operationTypes" ng-disabled="entity.id"></select></div></div><br><div class="row"><div class="col-md-6"><label gumga-translate-tag="businessrule.whenthevalueis">When the value is</label></div><div class="col-md-2"><label gumga-translate-tag="businessrule.duraction">Duraction</label></div></div><div class="row"><div class="col-md-2"><select class="form-control" ng-options="op.key as op.label for op in operators" ng-model="entity.operatorType" ng-disabled="entity.id" ng-change="entity.value = 0"></select></div><div class="col-md-2"><input type="text" class="form-control" ng-model="entity.value" ui-money-mask ng-disabled="!entity.operatorType || entity.operatorType == \' \' || entity.id"></div><div class="col-md-2"><gumga-date ng-model="entity.startDuraction" id="startdate" name="startdate" configuration="configStartDate"></gumga-date></div><div class="col-md-1"><label gumga-translate-tag="businessrule.until" class="custom-span text-muted">Until</label></div><div class="col-md-2"><gumga-date ng-model="entity.endDuraction" id="enddate" name="enddate" configuration="configEndDate"></gumga-date></div><div class="col-md-3"><button type="button" ng-click="clickedBtnGreen = true; clickedBtnBlue = false" style="color: #fff" class="btn button-green" ng-disabled="entity.id"><i class="fa fa-check"></i><span gumga-translate-tag="billing.atsight">At Sight</span></button><button type="button" ng-click="clickedBtnGreen = false; clickedBtnBlue = true;changeTerm()" style="color: #fff" class="btn button-blue" ng-disabled="entity.id"><i class="fa fa-calendar-check-o"></i><span>A Prazo</span></button></div></div></div></div></div></div><div class="row" ng-show="clickedBtnBlue || clickedBtnGreen"><div class="col-lg-12"><div class="ibox float-e-margins"><div class="ibox-content"><div class="row"><div class="col-md-6"><h3 gumga-translate-tag="businessrule.entry">Entry</h3></div><div class="col-md-6"><h3 gumga-translate-tag="businessrule.discount">Discount</h3></div></div><div class="row"><div class="col-md-3"><label gumga-translate-tag="businessrule.minimumvalueforentry">Minimum value for entry</label><grands-control-type model="entity.entryValue" type-value="entity.entryType" is-disabled="clickedBtnGreen || entity.id"></grands-control-type></div><div class="col-md-3"><label gumga-translate-tag="businessrule.tobepaid">to be paid</label><grands-payment-type color="btn-info" is-disabled="entity.id" selected-values="entity.entryPaymentTypes" multi="true" search="get(page,size)" page-size="5"></grands-payment-type></div><div class="col-md-3"><label gumga-translate-tag="businessrule.maximumdiscount">Maximum discount</label><grands-control-type model="entity.discount" type-value="entity.discountType" is-disabled="isDisabled || entity.id"></grands-control-type></div></div><br><div class="row container-fluid" ng-if="!hideInstallment()"><h3 gumga-translate-tag="businessrule.installment">Installment</h3></div><div class="row" ng-if="!hideInstallment()"><div class="col-md-2"><label gumga-translate-tag="businessrule.maxinstallment">Max Installment</label><strong class="text-danger" ng-show="clickedBtnBlue && entity.parcelsCount == null || entity.parcelsCount == \'\' ">*</strong><input type="number" class="form-control" ng-model="entity.parcelsCount" ng-change="minimumParcelsCount()" ng-disabled="entity.id"></div><div class="col-md-2"><label gumga-translate-tag="businessrule.tobepaid">to be paid</label><strong class="text-danger" ng-show="entity.parcelsPaymentTypes.length <= 0">*</strong><grands-payment-type is-disabled="entity.id" color="btn-info" selected-values="entity.parcelsPaymentTypes" multi="true" search="get(page,size)" page-size="5"></grands-payment-type></div><div class="col-md-offset-2 col-md-2"><div class="row container-fluid"><label gumga-translate-tag="businessrule.recurrence">Recurrence</label></div><input type="checkbox" ng-model="entity.recurrence.value" ng-disabled="entity.id"><span gumga-translate-tag="businessrule.monthly">Monthly</span></div><div class="col-md-4" ng-hide="disabledNegotiationInterval()"><div class="row container-fluid"><label gumga-translate-tag="businessrule.installmentsinterval">Installments interval</label><strong class="text-danger" ng-show="entity.recurrence.value == false && entity.negotiationInterval == \'\' ">*</strong></div><div class="row"><div class="col-md-4"><input type="number" class="form-control" ng-model="entity.negotiationInterval" ng-change="minimumNegotiationInterval()" ng-disabled="disabledNegotiationInterval() || entity.id"></div><div class="col-md-1"><label class="custom-label-days text-muted" gumga-translate-tag="businessrule.days">Days</label></div></div></div></div><br><div class="row container-fluid"><div class="pull-right"><button type="button" class="btn btn-primary pull-right button-add" ng-click="addRules(entity)" ng-disabled="blockBtnAdd()" ng-hide="entity.id"><span><span class="fa fa-plus"></span></span><span gumga-translate-tag="businessrule.add" class="ng-scope">Add</span></button><button type="button" class="btn btn-primary pull-right button-ok" ng-show="entity.id" ng-click="saveOnEdit(entity)" ng-disabled="!entity.entryValue || !entity.parcelsCount"><span><span class="fa fa-check"></span></span><span gumga-translate-tag="button.save" class="ng-scope">Save</span></button></div></div></div></div></div></div><div class="row" ng-show="rules.length > 0 || !entity.id"><div class="col-lg-12"><div class="ibox float-e-margins"><div class="ibox-content"><div class="row"><div class="table-responsive"><gumga-list data="rules" configuration="conf" class="table-bordered"></gumga-list></div></div></div></div></div></div><div class="pull-right"><button type="button" ui-sref="businessrule.list" grands-button="return" ng-show="entity.id"></button><button type="button" ui-sref="businessrule.list" grands-button="cancel" ng-hide="entity.id"></button><button type="button" ng-disabled="rules.length <= 0" ng-click="update(rules)" grands-button="save"></button></div></form>'),e.put("modules/businessrule/views/list.html",'<div class="row"><div class="col-lg-12"><div class="ibox float-e-margins"><div class="ibox-content"><div class="row"><div class="col-md-12"><div class="col-md-5"><button type="button" ui-sref="businessrule.stepone" grands-button="new"></button></div><div class="col-md-7"><gumga-query search="businessrule.methods.search(field, param)" advanced-search="businessrule.methods.advancedSearch(param)"><search-field field="name" label="{{\'name\'|gumgaTranslate:\'businessrule\'}}" select="true"></search-field><search-field field="maximumdiscount" label="{{\'maximumdiscount\'|gumgaTranslate:\'businessrule\'}}"></search-field><search-field field="entryvalue" label="{{\'entryvalue\'|gumgaTranslate:\'businessrule\'}}"></search-field><search-field field="parcelscount" label="{{\'parcelscount\'|gumgaTranslate:\'businessrule\'}}"></search-field><search-field field="negotiationinterval" label="{{\'negotiationinterval\'|gumgaTranslate:\'businessrule\'}}"></search-field><advanced-search-field type="string" label="{{\'maximumdiscount\'|gumgaTranslate:\'businessrule\'}}" field="maximumdiscount"></advanced-search-field><advanced-search-field type="string" label="{{\'entryvalue\'|gumgaTranslate:\'businessrule\'}}" field="entryvalue"></advanced-search-field><advanced-search-field type="string" label="{{\'parcelscount\'|gumgaTranslate:\'businessrule\'}}" field="parcelscount"></advanced-search-field><advanced-search-field type="string" label="{{\'negotiationinterval\'|gumgaTranslate:\'businessrule\'}}" field="negotiationinterval"></advanced-search-field></gumga-query></div><div class="col-md-12 m-t"><gumga-list data="businessrule.data" configuration="conf" class="table-striped gmd" sort="businessrule.methods.sort(field, dir)" page-size="businessrule.pageSize" count="businessrule.count" page-model="businessrule.page" max-height="400px" on-page-change="businessrule.methods.get(page, pageSize)"></gumga-list></div></div></div></div></div></div></div>'),e.put("modules/stock/views/form.html",'<form name="forms" novalidate><div class="row"><div class="col-lg-6"><div class="ibox float-e-margins"><div class="ibox-title"><h5><span gumga-translate-tag="stock.title">Title</span></h5></div><div class="ibox-content"><div class="row"><div class="col-md-12"><label gumga-translate-tag="stock.type">Type</label></div><div class="col-md-12"><div class="btn-group" ng-init="typeAux = \'\'"><button class="btn" ng-click="typeAux = treePattern[2];objAux = {name:objAux.name,description:objAux.description}; focusName = true;createObject();" ng-class="typeAux == treePattern[2]?\'btn-default\':\'btn-white\'" type="button"><span gumga-translate-tag="stock.typeofoperation">Type of Operation</span></button></div></div><div class="col-md-12"><label for="name" gumga-translate-tag="stock.name">name</label><input id="name" type="text" name="name" ng-model="objAux.name" class="form-control" ng-disabled="typeAux == \'\'"><div ng-if="typeAux == treePattern[1]"><label for="descrition" gumga-translate-tag="stock.descrition">Descrition</label><input id="descrition" type="text" name="descrition" ng-model="objAux.descrition" class="form-control"></div><div ng-if="typeAux == treePattern[2]"><label gumga-translate-tag="stock.invoiceobjective">Invoice Objective</label><select class="form-control" ng-model="objAux.invoiceObjective" ng-options="df.key as df.label for df in documentFinalityList"></select></div><div ng-if="typeAux == treePattern[2]"><label gumga-translate-tag="stock.operationcategory">Operation Category</label><strong class="text-danger">*</strong><select class="form-control" ng-model="objAux.operationCategory" ng-options="oc.key as oc.label for oc in operationCategoryList"></select></div><div ng-if="typeAux == treePattern[2]"><div class="row"><div class="col-md-12 m-t"><label for="descrition" gumga-translate-tag="stock.message">Message</label><textarea id="message" name="message" class="form-control" ng-model="objAux.message" style="resize: none; height: 100px" maxlength="5000" gumga-counter="5000"></textarea></div></div></div><button class="btn btn-primary pull-right m-t button-add" ng-click="objAux = addNew(objAux,typeAux)" ng-disabled="typeAux == \'\' || objAux.name == null || objAux.name == \'\'"><span class="fa fa-plus"></span><span gumga-translate-tag="stock.add">add</span></button></div></div></div></div></div></div><div class="row"><div class="col-lg-12"><div class="ibox float-e-margins"><div class="ibox-title"><h5><span gumga-translate-tag="stock.entranceandexit">Entrance and Exit</span></h5></div><div class="ibox-content"><div class="row"><grands-category-tree list="array" model-list="list" pattern="treePattern" charac-origin="OPERATION" type-attribute="stockType" get-childrens="getChildrens(id,type)" update-entity="editOperation(data)" enable-remove="removable(data)" delete-functions="deleteFunctions"></grands-category-tree></div></div></div></div></div><div class="pull-right"><button type="button" grands-button="return" ui-sref="home.base" ng-show="entity.id"></button><button type="button" grands-button="cancel" ui-sref="home.base" ng-hide="entity.id"></button><button type="button" grands-button="save" ng-click="update(list)" ng-disabled="forms.$invalid"></button></div></form>')}]),angular.module("app.businessrule.services",["api.location"]),angular.module("app.stock.services",["api.location"]),angular.module("app.businessrule",["ui.router","app.businessrule.controllers","app.businessrule.services","api.location"]).config(["$stateProvider","apiLocation",function(e,t){e.state("businessrule.list",{url:"/list",templateUrl:"modules/businessrule/views/list.html",controller:"BusinessRuleListController",data:{id:2}}).state("businessrule.stepone",{url:"/insert/stepone",templateUrl:"modules/businessrule/views/BusinessRuleStepOne.html",controller:"BusinessRuleStepOneController",data:{id:3},resolve:{operations:["OperationTypeService",function(e){return e.allWithTenancy().then(function(e){return e.data})}]}}).state("businessrule.steptwo",{url:"/insert/steptwo",templateUrl:"modules/businessrule/views/BusinessRuleStepTwo.html",controller:"BusinessRuleStepTwoController",data:{id:3},params:{operations:null},resolve:{operations:["$stateParams",function(e){return e.operations||[]}]}})}]),angular.module("app.stock",["ui.router","app.stock.controllers","app.stock.services"]).config(["$stateProvider",function(e){e.state("stock.insert",{url:"/insert",templateUrl:"modules/stock/views/form.html",controller:"StockFormController",controllerAs:"form",data:{id:3},resolve:{entity:function(){return{}}}})}]),angular.module("app.businessrule.controllers",["app.businessrule.services","ui.router","paymenttype.core"]),angular.module("app.stock.controllers",["app.stock.services","ui.router"]),angular.module("operationtype.core",["ui.router","ngSanitize","gumga.core","brasil.filters","ui.utils.masks","datePicker","app.stock","app.businessrule","operationtype.templates","paymenttype.core","characteristic.core"]).config(["$stateProvider",function(e){e.state("stock",{data:{id:1},url:"/stock",templateUrl:"baseOperationType.html"}).state("businessrule",{data:{id:1},url:"/businessrule",templateUrl:"baseOperationType.html"})}]),angular.module("app.businessrule.services").service("BusinessRuleService",["GumgaRest","apiLocation","$q","$http",function(e,t,n,a){var s=new e(t+"/api/businessrule");return s.update=function(e){var t=e.identifier;return delete e.identifier,s.save(e).then(function(e){return e.identifier=t,e})},s.saveEntityRule=function(e){var t=e.map(s.update);return n.all(t)},s.getOperatorType=function(){return s.extend("get","/operatorType")},s.getValueType=function(){return s.extend("get","/valueType")},s.changeStatus=function(e){return s.extend("get","/changestatus/".concat(e))},s.saveWithOperationType=function(e,t){return s.extend("post","/manywithoperation",{rules:t,operationTypes:e})},s}]),angular.module("app.stock.services").service("OperationTypeService",["GumgaRest","apiLocation","$q",function(e,t,n){var a=new e(t.concat("/api/operationtype"));return a.recoverByCategory=function(e){return a.extend("get","/recover-by-category?category=".concat(e))},a.saveAll=function(e){var t=e.map(a.update);return n.all(t)},a.all=function(){return a.extend("get","/all")},a.allWithTenancy=function(){return a.extend("get","/getallwithtenancy")},a.recoveryAllByCategory=function(e){return a.extend("get","/recoveryallbycategory?category="+e)},a.recoveryOperationCategoryDto=function(){return a.extend("get","/recoveryoperationcategory")},a.addBusinessRules=function(e,t){return a.extend("post","/addbusinessrules/".concat(e),t)},a}]),angular.module("app.stock.services").service("StockService",["GumgaRest","apiLocation","$q",function(e,t,n){function a(e){return s.extend("post","/tree/save",e)}var s=new e(t.concat("/api/operation"));return s.saveTree=function(e){var t=e.map(a);return n.all(t)},s.getTree=function(){return s.extend("get","/tree")},s.getChildrens=function(e,t){return s.extend("get","/tree/childrens/".concat(t).concat("/").concat(e))},s}]),angular.module("app.businessrule.controllers").controller("BusinessRuleFormController",["$state","entity","$scope","BusinessRuleService","PaymentTypeService","operationTypes","OperationTypeService",function(e,t,n,a,s,i,l){var o=0;a.resetDefaultState(),s.resetDefaultState(),n.entity=angular.copy(t.data),n.continue={},n.rules=[],n.combinations=[],n.content={},n.page=1,n.entity.discount=n.entity.discount||0,n.entity.discountType=n.entity.discountType||"",n.entity.entryType=n.entity.entryType||"",n.entity.entryValue=n.entity.entryValue||0,n.entity.entryPaymentTypes=n.entity.entryPaymentTypes||[],n.entity.parcelsPaymentTypes=n.entity.parcelsPaymentTypes||[],n.entity.hasEntry=n.entity.hasEntry||{value:!1},n.entity.operationOwner=n.entity.operationOwner||"",n.operationTypes=i,n.entity.recurrence=n.entity.recurrence||{value:!0},n.atualDate=new Date,n.entity.startDuraction=new Date,n.entity.value=0;var r=function(){n.entity.discount=0,n.entity.hasEntry={value:!1},n.entity.entryValue=0,n.entity.parcelsCount=0,n.entity.negotiationInterval=0,n.entity.value=0,n.entity.startDuraction=new Date,n.entity.endDuraction=null,n.entity.operatorType=null,n.entity.entryType="VALUE",n.entity.discountType="VALUE",n.clickedBtnBlue=!1,n.clickedBtnGreen=!1,n.entity.operationOwner=[],n.entity.entryPaymentTypes=[],n.entity.parcelsPaymentTypes=[],n.entity.recurrence={value:!0}};"PERCENTAGE"===n.entity.entryType&&1===n.entity.entryValue?n.clickedBtnGreen=!0:n.entity.id?n.clickedBtnBlue=!0:angular.noop,n.get=function(e,t){return s.get(e,t).then(function(e){return e.data.values})},n.checkDate=function(e){if(void 0===n.entity[e]){var t=document.getElementById(e).value,a=t.split("/").map(function(e){return parseInt(e)});3===a.filter(function(e){return"number"==typeof e}).length&&(n.entity[e]=new Date(a[2],a[1]-1,a[0])),void 0===n.entity[e]&&(document.getElementById(e).value=null)}},n.minimumParcelsCount=function(){n.entity.parcelsCount<0&&(n.entity.parcelsCount=0)},n.minimumNegotiationInterval=function(){n.entity.negotiationInterval<0&&(n.entity.negotiationInterval=0)},n.conf={columns:"association,whenthevalueis,entryValue,discount,parcelsCount,negotiationInterval,start,end,button",selection:"single",columnsConfig:[{name:"association",size:"col-md-2",title:'<strong gumga-translate-tag="businessrule.movementtype">Movement type</strong>',content:"{{$value.operationOwner.name}}"},{name:"whenthevalueis",size:"col-md-2",title:'<strong gumga-translate-tag="businessrule.whenthevalueis">When the value is</strong>',content:'<div ng-show="$value.value > 0">{{$value.operatorType}}: {{$value.value | currency:\'R$\'}}</div><div ng-hide="$value.value > 0"><span gumga-translate-tag="label.all">All</span></div>'},{name:"entryValue",size:"col-md-1",title:'<strong gumga-translate-tag="businessrule.entryvalue">Entry value</strong>',content:"<div ng-show=\"$value.entryType == 'PERCENTAGE' \">{{$value.entryValue * 100}}%</div><div ng-show=\"$value.entryType == 'VALUE' \">{{$value.entryValue | currency:'R$'}}</div>"},{name:"discount",size:"col-md-1",title:'<strong gumga-translate-tag="businessrule.maxdiscount">Max discount</strong>',content:"<div ng-show=\"$value.discountType == 'PERCENTAGE' \">{{$value.discount * 100}}%</div><div ng-show=\"$value.discountType == 'VALUE' \">{{$value.discount | currency:'R$'}}</div>"},{name:"parcelsCount",size:"col-md-1",title:'<strong gumga-translate-tag="businessrule.parcelscount">Parcels count</strong>',content:"<div>{{$value.parcelsCount}}</div>"},{name:"negotiationInterval",size:"col-md-2",title:'<strong gumga-translate-tag="businessrule.installmentsinterval">Installments interval</strong>',content:'<div ng-show="$value.negotiationInterval > 1">{{$value.negotiationInterval}} dias</div><div ng-show="$value.negotiationInterval == 1">{{$value.negotiationInterval}} dia</div><div ng-show="$value.negotiationInterval == 0">----------</div>'},{name:"start",size:"col-md-1",title:'<strong gumga-translate-tag="businessrule.start">Start</strong>',content:"<div>{{$value.startDuraction | date: 'dd/MM/yyyy'}}</div>"},{name:"end",size:"col-md-1",title:'<strong gumga-translate-tag="businessrule.end">End</strong>',content:"<div>{{$value.endDuraction | date: 'dd/MM/yyyy'}}</div>"},{name:"button",title:" ",size:"col-md-1",content:'<button type="button" class="btn btn-danger btn-xs pull-right button-delete" ng-click="$parent.$parent.removeRule($index)"><span class="glyphicon glyphicon-remove"></span></button>'}]},n.addRules=function(e){var t=angular.copy(e);t.hasEntry={value:null!=t.entryValue&&0!==t.entryValue},t.identifier=o++,delete t.operationOwner,e.operationOwner.map(function(e){return t.operationOwner=e,angular.copy(t)}).forEach(function(e){n.rules.push(e)}),n.combinations.push(t),r()},n.removeRule=function(e){n.rules&&n.rules.splice(e,1)},n.update=function(t){var n=angular.copy(t),s=[],i={};n=n.filter(function(e){var t=!s[e.identifier];return i[e.identifier]=i[e.identifier]||[],i[e.identifier].push(e.operationOwner),s[e.identifier]=!0,t}).map(function(e){return e.id=e.id?e.id:null," "===e.operatorType&&(e.operatorType=null),delete e.operationOwner,e}),a.saveEntityRule(n).then(function(t){var n={};t.forEach(function(e){i[e.identifier].forEach(function(t){n[t.id]=n[t.id]||[],n[t.id].push(e.data.data.id)})});for(var a in n)l.addBusinessRules(a,n[a]);e.go("businessrule.list")})},n.saveOnEdit=function(t){a.update(t).then(function(){n.continue.insert?n.entity=angular.copy(t.data):e.go("businessrule.list")})},a.getOperatorType().success(function(e){n.operators=e}),a.getValueType().success(function(e){n.valueTypes=e}),n.blockBtnAdd=function(){return n.clickedBtnBlue?0===n.entity.operationOwner.length||!n.entity.startDuraction||0===n.entity.parcelsCount||n.entity.entryValue>0&&0===n.entity.entryPaymentTypes.length||0===n.entity.entryValue&&n.entity.entryPaymentTypes.length>0||0===n.entity.parcelsPaymentTypes.length||n.entity.recurrence.value===!1&&0===n.entity.negotiationInterval:n.entity.operationOwner.length<=0||!n.entity.startDuraction||n.entity.entryPaymentTypes.length<=0||void 0},n.$watch("entity.discount",function(){"PERCENTAGE"===n.entity.discountType&&n.entity.discount>1&&(n.entity.discount=1)}),n.$watch("entity.discountType",function(){n.entity.discountType&&!n.entity.id&&(n.entity.discount=0)}),n.$watch("entity.entryValue",function(){"PERCENTAGE"===n.entity.entryType&&!n.entity.id&&n.clickedBtnBlue&&n.entity.entryValue>.99&&(n.entity.entryValue=.99)}),n.$watch("entity.entryType",function(){
n.clickedBtnBlue&&n.entity.entryType&&(n.entity.entryValue=0)}),n.$watch("clickedBtnGreen",function(){n.clickedBtnGreen&&!n.entity.id&&(n.entity.entryType="PERCENTAGE",n.entity.entryValue=1)}),n.$watch("entity.recurrence.value",function(){n.entity.recurrence.value===!0&&(n.entity.negotiationInterval=0)}),n.hideInstallment=function(){if(n.clickedBtnGreen)return!0},n.disabledNegotiationInterval=function(){if(n.entity.recurrence.value===!0)return!0},n.changeTerm=function(){"PERCENTAGE"===n.entity.entryType&&1===n.entity.entryValue&&(n.entity.entryValue=.99)},n.changeStartDate=function(e){(e&&n.entity.endDuraction&&e>n.entity.endDuraction||!e)&&(n.entity.endDuraction="")},n.changeEndDate=function(e){var t=n.entity.startDuraction;"string"==typeof t&&(t=new Date(t)),(t&&e&&t>e||!t)&&(n.entity.endDuraction="")},n.configStartDate={change:function(e){n.changeStartDate(e)}},n.configEndDate={change:function(e){e=new Date(e),n.changeEndDate(e)}}}]),angular.module("app.businessrule.controllers").controller("BusinessRuleListController",["$scope","gumgaController","BusinessRuleService","$rootScope",function(e,t,n,a){t.createRestMethods(e,n,"businessrule"),e.businessrule.execute("reset"),e.businessrule.execute("get"),e.businessrule.on("deleteSuccess",function(){e.businessrule.execute("get")}),e.conf={columns:"parcelsCount,status,button",selection:"none",checkbox:!1,materialTheme:!0,itemsPerPage:[5,10,25,50,100],title:"Listagem de Regras comerciais",columnsConfig:[{name:"discount",size:"col-md-1",title:'<strong gumga-translate-tag="businessrule.maximumdiscount">Maximum discount</strong>',content:"<div ng-show=\"$value.discountType == 'PERCENTAGE' \">{{$value.discount * 100}}%</div><div ng-show=\"$value.discountType == 'VALUE' \">{{$value.discount | currency:'R$'}}</div>"},{name:"valueRestriction",size:"col-md-1",title:'<strong gumga-translate-tag="businessrule.valuerestriction">When the value go</strong>',content:'<div ng-show="$value.value > 0">{{$parent.$parent.format[$value.operatorType]}}: {{$value.value | currency:\'R$\'}}</div><div ng-hide="$value.value > 0"><span gumga-translate-tag="label.all">For All</span></div>'},{name:"entryValue",size:"col-md-1",title:'<strong gumga-translate-tag="businessrule.entryvalue">Entry value</strong>',content:"<div ng-show=\"$value.entryType == 'PERCENTAGE' \">{{$value.entryValue * 100}}%</div><div ng-show=\"$value.entryType == 'VALUE' \">{{$value.entryValue | currency:'R$'}}</div>"},{name:"parcelsCount",size:"col-md-1",title:'<strong gumga-translate-tag="businessrule.parcelscount">Parcels count</strong>',content:'<div ng-show="$value.parcelsCount > 1">{{$value.parcelsCount}} vezes</div><div ng-show="$value.parcelsCount == 1">{{$value.parcelsCount}} vez</div><div ng-show="$value.parcelsCount == 0">----------</div>'},{name:"negotiationInterval",size:"col-md-1",title:'<strong gumga-translate-tag="businessrule.negotiationinterval">Negotiation interval</strong>',content:'<div ng-show="$value.negotiationInterval > 1">{{$value.negotiationInterval}} dias</div><div ng-show="$value.negotiationInterval == 1">{{$value.negotiationInterval}} dia</div><div ng-show="$value.negotiationInterval == 0">----------</div>'},{name:"start",size:"col-md-1",title:'<strong gumga-translate-tag="businessrule.start">Start</strong>',content:"{{$value.startDuraction | date:'dd/MM/yyyy'}}"},{name:"end",size:"col-md-1",title:'<strong gumga-translate-tag="businessrule.end">End</strong>',content:"{{$value.endDuraction | date:'dd/MM/yyyy'}}"},{name:"status",size:"col-md-1",title:'<div align="center"><strong gumga-translate-tag="businessrule.status">status</strong></div>',content:'<div align="center"><span class="badge badge-primary" ng-show="$value.active"  gumga-translate-tag="businessrule.active">Ativo</span><span class="badge badge-danger"  ng-show="!$value.active" gumga-translate-tag="businessrule.inative" >Inativo</span> </div>'},{name:"button",title:" ",size:"col-md-1",content:'<div align="center"><button ng-show="$value.active" type="button" ng-click="$parent.$parent.changeStatus($value)" class="btn-link center-block text-danger" uib-tooltip="Desativar"><i class="fa fa-times"></i></button><button ng-show="!$value.active" type="button" ng-click="$parent.$parent.changeStatus($value)" class="btn-link center-block text-success" uib-tooltip="Ativar"><i class="fa fa-check"></i></button></div>'}]},e.changeStatus=function(t){a.$broadcast("hideNextMessage",!0),n.changeStatus(t.id).then(function(t){e.businessrule.execute("get")})},e.format={},e.format.IGUAL_A="Igual a",e.format.MAIOR_QUE="Maior que",e.format.MAIOR_OU_IGUAL_QUE="Maior ou igual a"}]),angular.module("app.businessrule.controllers").controller("BusinessRuleStepOneController",["$scope","$state","operations",function(e,t,n){e.operations=angular.copy(n),e.selectedOperations=[],e.onSelectedOperation=function(t){e.operations.forEach(function(n,a){t.id==n.id&&e.operations.splice(a,1)}),e.selectedOperations.push(t)},e.removeOperation=function(t){e.selectedOperations.forEach(function(n,a){t.id==n.id&&e.selectedOperations.splice(a,1)}),e.operations.unshift(t)},e.conf={columns:"name",selection:"multi",checkbox:!1,materialTheme:!0,fixed:{head:!0},columnsConfig:[{name:"name",size:"col-md-11",title:'<strong class="text-center" >Nome</strong>',content:"{{$value.name }}"}]},e.back=function(){t.go("businessrule.list")},e.nextStep=function(){t.go("businessrule.steptwo",{operations:e.selectedOperations})}}]),angular.module("app.businessrule.controllers").controller("BusinessRuleStepTwoController",["$scope","$state","operations","SweetAlert","PaymentTypeService","BusinessRuleService",function(e,t,n,a,s,i){e.operations=angular.copy(n),i.getNew().then(function(t){e.new=t.data}),e.operations&&e.operations.length||a.swal({title:"Nenhuma operação foi selecionada.",text:"Você será redirecionado para a seleção de operação para poder continuar com o cadastro.",type:"warning",confirmButtonText:"OK",closeOnConfirm:!0},function(){t.go("businessrule.stepone")}),e.active=!0,e.selectedEntryType=[],e.selectedParcelType=[],s.getAll().then(function(t){e.paymentTypes=t.data.map(function(e){return e.parcelsCount=1,e})}),e.onChangeRow=function(t){e.paymentTypes.forEach(function(e){e.id==t.id&&(e.parcelsCount=t.parcelsCount)}),e.selectedParcelType.forEach(function(e){e.id==t.id&&(e.parcelsCount=t.parcelsCount)})},e.changeMethod=function(t){e.entry="ENTRY"===t,e.parcel=!e.entry,e.selectedEntryType=[],e.selectedParcelType=[],e.paymentTypes=angular.copy(e.paymentTypes).map(function(e){return e.parcelsCount=1,e})},e.confBase={columns:"name,parcelsCount",selection:"multi",checkbox:!0,materialTheme:!0,fixed:{head:!0},columnsConfig:[{name:"name",size:"col-md-11",title:'<strong class="text-center" >Nome</strong>',content:"{{$value.name }}"},{name:"parcelsCount",editable:!0,size:"col-md-11",title:'<strong class="text-center" >Parcelas</strong>&nbsp;<span class="glyphicon glyphicon-question-sign btn-link" uib-tooltip="Clique duas vezes sobre o valor para editar o número de parcelas" tooltip-placement="bottom" style="cursor: pointer"></span>',content:"{{$value.parcelsCount }}"}]},e.confEntry=angular.copy(e.confBase),e.confParcel=angular.copy(e.confBase),e.confEntry.columns="name",e.back=function(){t.go("businessrule.stepone")},e.generate=function(){var n=e.entry?e.selectedEntryType:e.selectedParcelType,a=[],s=[];n.forEach(function(e){for(var t=e.parcelsCount,n=1;n<=t;n++)s[n]=s[n]||[],s[n].push(e)});for(var l=1;l<=s.length-1;l++){var o=angular.copy(e.new);o.maxDiscount=100,o.discountType="PERCENTAGE",o.hasEntry=e.entry,o.minValue=0,o.startDuration=new Date,o.active=e.active,o.negotiationInterval=0,o.hasEntry?(o.entryValue=1,o.entryType="PERCENTAGE",o.entryPaymentTypes=s[l],o.parcelsCount=0):(o.entryValue=0,o.parcelsCount=l,o.parcelsPaymentTypes=s[l],o.monthly=!0),a.push(o)}i.saveWithOperationType(e.operations,a).then(function(){t.go("businessrule.list")})},e.disableBtnSave=function(){return e.entry&&!e.selectedEntryType.length||e.parcel&&!e.selectedParcelType.length}}]),angular.module("app.stock.controllers").controller("StockFormController",["StockService","entity","$scope","NotesQueryService","OperationTypeService","$q",function(e,t,n,a,s,i){e.resetDefaultState(),n.entity=angular.copy(t.data),n.continue={},n.atributos=[],n.status={isProdutoOpen:!0},n.array=[],n.list=[],n.treePattern=["OPERATION","OPERATION","OPERATIONTYPE"];var l=null;e.getTree().then(function(e){n.list=e.data.data}),n.getChildrens=function(t,n){return e.getChildrens(t,n)};var o=function(e){var t={};return t.id=e.id,t.version=e.version,t.name=e.name,t.characteristicsPT=e.characteristicsPT,t.characteristics=e.characteristics,t.description=e.description,t.informative=e.informative,t.stockType=e.stockType,t.father=e.father,t.fixedCharacteristics=e.fixedCharacteristics,t.operationCategory=e.operationCategory,t.invoiceObjective=e.invoiceObjective,t.message=e.message,t.editable="OPERATIONTYPE"===e.stockType,e.childrens=e.childrens||[],t.childrens=e.childrens.map(o),t.integrationId=e.integrationId,t.stockType===n.treePattern[2]&&(t.informative=!1),t};n.update=function(t){var a=t.map(o);e.saveTree(a).then(function(){e.getTree().then(function(e){n.list=e.data.data})})},n.editOperation=function(e){return n.typeAux=e.stockType,n.objAux=e,l=i.defer(),l.promise},n.removable=function(e){return"OPERATIONTYPE"===e.stockType},n.addNew=function(e,t){if(l)l.resolve(e),l=null,n.typeAux="";else{e.childrens=[],e.characteristics=[],e.characteristicsPT=[];var a=angular.copy(e);a.stockType=t,n.array.push(a)}return{}},n.deleteItem=function(e,t){"CATEGORY"===e?n.arrayCategory.splice(t,1):n.arrayType.splice(t,1)},n.createObject=function(){n.objAux={name:"",invoiceObjective:"",operationCategory:"",message:"",fixedCharacteristics:{allowFreight:!0,allowStockMovement:!0,allowCashMovement:!0,allowNFe:!0,allowNFCe:!0,quickSale:!0}}},n.deleteFunctions=[],n.deleteFunctions[2]=function(e){return s.deleteCollection([e])},a.getDocumentFinality().then(function(e){n.documentFinalityList=e.data}),s.recoveryOperationCategoryDto().then(function(e){n.operationCategoryList=e.data})}]);